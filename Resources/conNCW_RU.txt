Утилита для конвертирования между файлами Kontakt NCW и WAV
0. Отказ от ответственности
1. Что это вообще?
2. Описание командной строки
3. Проблемы
4. Обновления
5. -

---------------------------------------------------------
0. Отказ от ответственности
 
 Данное программное обеспечени поставляется "как есть" без явных или
 подразумеваемых гарантий, включая, но не ограничиваясь предполагаемую
 гарантии коммерческой выгоды, пригодности для конкретных целей и 
 ненарушения прав. Ни при каких условиях создатель или распространитель
 данного программного обеспечения не может быть ответственен за любой 
 прямой, непрямой, случайный, умышленный, косвенный или иной ущерб 
 (включая, но не ограничиваясь, непредоставление товаров или услуг,
 потерю информации, упущенную выгоду и иные убытки в коммерческой 
 деятельности), какими бы аргументами он не был подтвержден и обоснован,
 проистекающий из использования или невозможности использования данного
 программного обеспечения, даже если в руководстве есть указание на
 вероятность такого ущерба.

 Короче, вы поняли
 
---------------------------------------------------------
1. Что это вообще?
 Эта программа позволяет конвертировать из WAW файлов в NCW, и обратно.
 NCW файлы используются программой Kontakt от Native Instruments. NCW -
 это сжатый формат аудио без потерь. Существует несколько способов
 такого конвертирования, используя Kontakt (batch-resave, если сэмплы
 прописаны в инструменте; соаздние временного инструмента с последующим
 созранением, итд). Но, если по каким-то причинам вам нужно конвертировать
 файлы без Kontakt'а, можно использовать эту утилиту.
 
--------------------------------------------------------- 

2. Описание командной строки

 Программа работает в трех режимах: 
  режим файлов, режим каталогов и режим списка.
  
 Вкратце, если указан флаг -l   - программа работает в режиме списка
 Если флаг -l не указан, то программа работает:
   в режиме файлов    - если первый не-флаговый параметр - имя файла
   в режиме каталогов - если первый не-флаговый параметр - имя каталога
 
 -------------------------
 Режим файлов:
	
  Если первый не-флаговый параметр - WAV или NCW файл, то программа работает
  в файловом режиме (при отсутствии флага -l)

  В файловом режиме можно указать только имя входного файла (файлов), или
  входного и выходного файла (файлов).
  Если вызодной файл не указан, программа создаст файл с тем же именем, что
  и входной, но с другим расширением.
  Если файл с таким именем уже существует, поведение зависит от 
  флага -rw (см. ниже)
  
  В простейшем случае команда выглядит так:
     CONNCW filename.WAV
  или
     CONNCW filename.NCW

    Направление конвертирования зависит от расширения файла. Так, в первом
    примере будет создан файл NCW, во втором - WAV. По умолчанию программа
    создает файл с тем же именем, но другим расширением
    Например
       CONNCW piano1.wav
    попытается создать файл piano1.ncw.
 
 -rw флаг (или -rewrite)
    По умолчанию, если файл с тем же именем, что и выходной, уже существует,
    программа поменяет имя выходного файла, добавив подчеркивание '_' и
    число, т.е.
       CONNCW violin.wav
    создаст файл 'violin_2.ncw', если 'violin.ncw' уже существует. Если же
    указан флаг -rw(-rewrite), то программа перезапишет существующий файл.
     
  Имя выходного файл можно задать напрямую:
     CONNCW input1.wav output1.ncw
  или
     CONNCW input1.ncw output1.wav
  
  Если файл с таким же именем как у выходного уже существует, дальнейшие ее
  действия зависят от наличия.отсутствия флага -rw (см. выше).
    
    
  В командной строке можно указать более одного файла
    CONNCW file1.wav file2.wav file3.wav...
  или
    CONNCW file1.ncw file2.ncw file3.ncw...
  
  Можно также задать имена выходных файлов напрямую:
    CONNCW input1.wav output1.ncw input2.wav output2.ncw...
  или
    CONNCW input1.ncw output1.wav input2.ncw output2.wav...
  Если после файла NCW указан файл WAV (или WAV идет после NCW), программа
  считает их парой входной-выходной файл.
  Если парное имя пропущено, программа не считает это ошибкой, она просто
  создаст файл с тем же именем, но другим расширением. Так что
     CONNCW piano1.wav my_piano1.ncw violin1.wav snare.wav my_snare.ncw
  вполне приемлемая команда, и она создаст файлы
     my_piano1.ncw, violin1.ncw, my_snare.ncw
  но я советую избегать такого использования ов избежание ошибок.
  
 -------------------------
 Режим каталогов:
  
  Если первый не-флаговый параметр - имя каталога, то программа работает
  в режиме каталогов (при отсутствии флага -l)

  В режиме каталогов обязательно нужно указать направление конвертирования,
  используя следующе флаги:
  
  -w2n    - конвертировать WAV файлы из указанного каталога
  -n2w    - конвертировать NCW файлы из указанного каталога
  
  Естественно, в режиме каталогов нужно обязательно указать каталог-источник,
  содержащие файлы для конвертирования, например
     CONNCW -w2n WAV_SAMPLES
     CONNCW -n2w D:\My_ncw_files
     итд
     
  Если выходной каталог не указан, программа будет создавать выходные файлы
  в том же каталоге (каталоге-источнике).
  Можно указать выходной каталог в командной строке:
     CONNCW -w2n source_dir dest_dir
     или
     CONNCW -n2w source_dir dest_dir
     
  Если файл с тем же именем, что и выходной, уже существует, поведение
  программы зависит от наличия/отсутствия флага -rw (см. выше)
  
  Если других флагов не указано, программа ищет файлы только в пределах
  каталога-источника, исключая подкаталоги. Если нужно конвертировать и
  те файлы, что находятся в подкаталогах - используйте флаг -r
    
  -r флаг (или -rec)  - рекурсивный поиск файлов для ковертирования
                        (включая подкаталогb каталога-источника)

  Если указаны и флаг -r, и выходной каталог, то структура выходного каталога
  будет скопирована с каталога-источника, т.е. со всеми нужными подкаталогами
  (подкаталогами, где найдены файлы для конвертирования)
  
 -------------------------
 Режим списка:
 
 -l флаг    - режим списка
 
 Если указан флаг -l, программа работает в режиме списка.
 
 В режиме списка обязательно нужно уазать имя файла списка
    CONNCW -l list_file
   
 Файл списка - это текстовый файл особого формата. Первая строка этого
 файла должна быть   @conncwlist1   или    @conncwlist2
 
 Если первая строка файла списка - @conncwlist1, то все следующие строки
 файла считаются именами входных файлов для конвертирования. Направление
 конвертирования зависит от расширения файла. Пример файла списка:
 	@conncwlist1
	piano1.wav
	piano2.wav
	violin.ncw
	...
	
 Если первая строка файла списка - @conncwlist2, тогда следующие строки
 файла считаются чередующимися парами входной-выходной файл. Первая строка
 - имя входного файла, вторая - входного, третья - входного, четвертая -
 выходного итд
 Разумеется, файлы в парах должны иметь разные расширения. Например:
 	@conncwlist2
	piano1.wav
	piano1.ncw
	piano2.wav
	piano2.ncw
	...
 Направление конвертирования зависит от расширения входного файла.
 
 -------------------------
 Заголова WAV файла
 По умолчанию программа создает WAV файлы со стадартным заголовоком.
 Некоторые программы могут требовать 'расширенный' заголовок для нетипичных
 сэмплов (сэмплрейт больше 44100, больше 16 бит, более 2 каналов итд).
 Поведение программы можно переопределить, используя следующие флаги:
  
   -whs         - стандартные заголовки для всех файлов (по умолчанию)
   -whe         - расширенные заголовки для всех файлов
   -wha         - авто режим. Прграмма создает стандартные заголовки для 
                типичных сэмплов, расширенные - для прочих.
		Типичные сэмплы: 8/16 бит, сэмплрейт <=44100
 
 -------------------------
 Командная строка вкратце:
  
     CONNCW [флаги] [файл1|кат1|файл_списка] [файл2|кат2] [файл3] [файл4] ...
     
     -h,-?         - показать детальную справку
     -rw,-rewrite  - перезаписывать существующие файлы
     -r,-rec	   - искать файлы также и в подкаталогах каталога-источника
     -w2n          - преобразование из WAV в NCW (в режимах фалов и списка - игнорируется)
     -n2w          - преобразование из NCW в WAV (в режимах фалов и списка - игнорируется)
     -l		   - режим списка
     -whs          - стандартные заголовки для всех файлов (по умолчанию)
     -whe          - расширенные заголовки для всех файлов
     -wha          - авто режим. Заголовки зависят от типа сэмплов
     
     
 Чуть конкретнее:
     CONNCW                  - показать короткую справку
     CONNCW -h	             - показать подробную справку
     CONNCW файл             - преобразовать файл в соответствии с расширением
     CONNCW файл1 файл2...   - преобразовать файл1,файл2...
     CONNCW -w2n кат         - преобразовать WAV файлы из каталога 'кат'
     CONNCW -n2w кат         - преобразовать NCW файлы из каталога 'кат'
     CONNCW -w2n кат1 кат2   - преобразовать WAV файлы из каталога 'кат1' и
                               записать выходные в каталог 'кат2'
     CONNCW -n2w кат1 кат2   - преобразовать NCW файлы из каталога 'кат1' и
                               записать выходные в каталог 'кат2'
     CONNCW -l файл_списка   - преобразовать файлы из файла списка
     итд
	
--------------------------------------------------------- 
3. Проблемы

 1. Прежде всего, NCW - закрытый формат, так что программа построена на базе
 догадок, предположений, проб и ошибок. Фактически, это бета-версия.
 Я проверил ее на сэмплах, которые у меня есть, но не могу дать гарантии,
 что она не споткнется на ваших сэмплах. Если это произойдет, пожалуйста,
 свяжитесь со мной и перешлите проблемные сэмплы.
 
 2. Программа не оптимизирована. С версии 0.3 программа конвертирует из
 WAV в NCW быстрее, чем Kontakt, а вот в обратную сторону (NCW->WAV) примерно
 в два раза медленнее, чем Kontakt. Если у кого есть желание помочь мне 
 с оптимизацией (читай - сделать ее за меня) - милости просим.
 
 3. Похоже, Kontakt не поддерживает 8-битные NCW, по крайней мере мой - 
 точно нет. Так что я не мог проверить, правильно ли работает конвертирование
 8-битных файлов. Скорее всего - нет. Фокус в формате хранения данных. 
 16 и 24 битные данные хранятся в стандартном для Intel формате 'дополнение
 до двойки', а вот 8-битные WAV хранят данные в формате 'сдвинутое число'.
 
 4. Поддерживается только PCM формат WAV файлов. Допустимый битрейт:
 8, 16, 24 и 32 бита.
 
 5. 32-битные сэмплы. Поведение разных программ с WAV файлами может быть 
 весьма непредсказуемым. Все, что за пределами стандартных 44100/16бит - 
 это небольшой хаос. Например, программы могут трактовать 32-битные сэмплы 
 по-разному: как 32-битное целое или же как 32-битное число с плавающей точкой.
 Хотя в заголовке есть данные, вроде 'байт типа сэмпла', программы все равно
 понимают его по-своему. Так что даже типичные значения из стандарта (1 или 3)
 трактуются по-разному (целое/вещественное) в зависимости от используемой вами
 программой или даже в зависимости от версии вашей программы.
 Я проверил программу на сэмплах моего 32-битного Kontakt'овского инструмента 
 - работает. Но эксперименты с сэмплами из других программ иногда давали 
 странные результаты. Имейте в виду.
 
 6. По тем же причинам WAV файлы, создаваемые Kontakt'ом могут отличаться от
 созданных данной программой. Kontakt иногда создает файлы, помеченные как
 'стандартные', хотя по факту они вовсе не стандартные. Разница в размере 
 заголовка. Kontakt иногда создает файлы с размерам заголовка 20 байт, в то
 время как стандартным является размер 16 байт. Не все программы принимают
 такие файлы (например 'SOX' не принимает). Моя программа создает файлы
 согласно стандарта (с 16-байтовым заголовком)
 Если есть необходимость, можно использовать утилитку 'correctWav', которая
 просто приводит эти нестандартные WAV файлы из Kontakt'а к стандартному 
 виду (изменяет размер заголовка на стандартные 16-байт).
 
 7. Снова заголовки WAV-файлов. Некоторые программы могут требовать расширенный
 формат заголовка для WAV файлов с нетипичными сэмплами (больше, чем 16 бит,
 сэмплрейт больше 44100, более 2 каналов итд). По этой причине я добавил флаги,
 позволяющие выбирать формат заголовка WAV файла (-whs,-whe,-wha). Я толком 
 не проверял  работу этих флагов с разными программами, так что используйте 
 на свой риск.
 
 --------------------------------------------------------- 
 4. Обновления
   версия 0.2  - имзенения от простой 'наивной'  версии, которая была 
   просто для проверки - будет ли все это работатью. Скорость сохранения
   WAV файлов, которая была просто ужасна, увеличена.
 
   версия 0.3 - некоторое ускорение за счет битовой оптимизации.
   
   версия 0.4 - добавлены флаги -whs,-whe,-wha для выбора типа заголовка
   создаваемых WAV файлов
 
 --------------------------------------------------------- 
5. -

 Если есть дикое желание написать свой конвертер с пасьянсом и Ларой Крофт,
 можете со мной связаться.
 Что знаю - расскажу.